### === ПЕРЕМЕННЫЕ ===
@baseUrl = http://localhost:3001
@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJjODAxYTliZi01MzBkLTQyMWEtYTVhOS1hZjk3ZGFmZmIyZTEiLCJyb2xlIjoiQURNSU4iLCJpYXQiOjE3NzAyNDcwNjYsImV4cCI6MTc3MDg1MTg2Nn0.wv9cfi8gCIcelH03rP16itOQAI-KAMA6fE9ajAGox9c
@tournamentId = a39ef1dd-a8f8-4023-8b1e-d2c1138398a1

### ============================================
### ЭТАП 8: LIVE STATE ТЕСТИРОВАНИЕ
### ============================================

### 1. Войти как администратор
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "phone": "+79991111111",
  "password": "admin123"
}

# ⚠️ СКОПИРУЙ token из ответа и замени @adminToken


### 2. Создать турнир для теста
POST {{baseUrl}}/tournaments
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "name": "Live State Test Tournament",
  "startTime": "2026-02-07T19:00:00Z",
  "buyInAmount": 1000,
  "startingStack": 10000
}

# ⚠️ СКОПИРУЙ id турнира и замени @tournamentId


### 3. Получить Live State (должен создаться автоматически)
GET {{baseUrl}}/tournaments/{{tournamentId}}/live
Authorization: Bearer {{adminToken}}


### 4. Пересчитать статистику
PATCH {{baseUrl}}/tournaments/{{tournamentId}}/live/recalculate
Authorization: Bearer {{adminToken}}


### 5. Обновить оставшееся время на уровне (установить 600 секунд = 10 минут)
PATCH {{baseUrl}}/tournaments/{{tournamentId}}/live/time
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "remainingSeconds": 600
}


### 6. Проверить Live State после обновления времени
GET {{baseUrl}}/tournaments/{{tournamentId}}/live
Authorization: Bearer {{adminToken}}


### 7. Поставить турнир на паузу
PATCH {{baseUrl}}/tournaments/{{tournamentId}}/pause
Authorization: Bearer {{adminToken}}


### 8. Проверить статус паузы
GET {{baseUrl}}/tournaments/{{tournamentId}}/live
Authorization: Bearer {{adminToken}}


### 9. Возобновить турнир
PATCH {{baseUrl}}/tournaments/{{tournamentId}}/resume
Authorization: Bearer {{adminToken}}


### 10. Проверить что турнир возобновлён
GET {{baseUrl}}/tournaments/{{tournamentId}}/live
Authorization: Bearer {{adminToken}}


### 11. Изменить статус турнира на RUNNING
PATCH {{baseUrl}}/tournaments/{{tournamentId}}/status
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "status": "RUNNING"
}


### 12. Обновить время до 120 секунд
PATCH {{baseUrl}}/tournaments/{{tournamentId}}/live/time
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "remainingSeconds": 120
}


### 13. Финальная проверка Live State
GET {{baseUrl}}/tournaments/{{tournamentId}}/live
Authorization: Bearer {{adminToken}}
